<!doctype html>
<html lang="ja">
    <link rel="stylesheet" media="screen and (max-width:768px)" href="./../../css/sp_style.css">    
    <link rel="stylesheet" media="screen and (min-width:769px)" href="./../../css/pc_style.css">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    </script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" }},
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
        },
        "HTML-CSS": { matchFontHeight: false },
        displayAlign: "left",
        displayIndent: "2em"
    });
    </script>
    <title>kdTree</title>
        

    </head>




    <body>
        
         <!--軽くコメント-->
        <div id="Inner">
            <h_middle style = "text-align: left;"><a href="../../index.html">前のページ</a> </h_middle>
            <section class = "Introduction">
                
                <h_big>   
                    kdTree<br></h_big>


            </section>


            <section class = "Explanation">
                kdTreeというデータ構造があります。
                <br>
                <br><a href ="https://tjkendev.github.io/procon-library/cpp/range_query/kd-tree.html">こちら</a>のサイトのコードを写経しました。
                <br>
                <br>
                <br>なんかまだよくわかっていませんが、二分探索木のk次元 ver です。
                <br>kdTree にはk次元座標上の点を保管できて、それら関して何らかのクエリを実行できます。
                <br>
                <br>二分探索の分割が、ブランチの深さによって異なる種類になっていて、例えば次元が２の時、枝分かれの深さが 2 で割って余りが 0 の深さなら y 座標を見て半分に分割、
                <br>2 で割った余りが 1 の時、x座標を見て半分に分割する。みたいな感じで、次数:k 個分の分割方法を駆使して二分探索木を構築しているようです。
                <br>
                <br>
                <br>この木でできることは、k 次元座標上の点や区間に対するクエリの処理で、
                <br>今回写経したコードでは ,
                <br>&ensp;&ensp;&ensp;&ensp;木に保管されている点のうち、(x,y)から最も近い点までの距離を計算
                <br>
                <br>&ensp;&ensp;&ensp;&ensp;木に保管されている点のうち、区間:[sx,tx]×[sy,ty]の内部(周上を含む)にある点を列挙する。
                <br>
                <br>ができます。
                <br>
                <br>実装の説明はいつかします。
                <br>
                <br>
                <br><a href = "https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=DSL_2_C">こちらの問題</a>でverifyしました。以下はコードです。
                <br>
                <br>
                <br>
                <br>

                <code>
                    <ol style="list-style:decimal-leading-zero outside;padding-left:36px;margin:0;background-color:#EEF;width:90%;line-height:14px;color:#000;font-size:12px;">
                    <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//include</font></li>
                    <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                    <li style="background-color:#EFF;">#include&lt;iostream&gt;</li>
                    <li style="background-color:#EEF;">#include&lt;vector&gt;</li>
                    <li style="background-color:#EFF;">#include&lt;queue&gt;</li>
                    <li style="background-color:#EEF;">#include&lt;map&gt;</li>
                    <li style="background-color:#EFF;">#include&lt;stack&gt;</li>
                    <li style="background-color:#EEF;">#include&lt;string&gt;</li>
                    <li style="background-color:#EFF;">#include&lt;complex&gt;</li>
                    <li style="background-color:#EEF;">#include&lt;algorithm&gt;</li>
                    <li style="background-color:#EFF;">using namespace std;</li>
                    <li style="background-color:#EEF;">const long long INF = 1e18;</li>
                    <li style="background-color:#EFF;">const double PI = 3.141592653589793;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;k demensional Tree</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;k次元座標上に、あらかじめいくつかの点が与えられる。このライブラリではk = 2。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;クエリ１ ... 矩形:[sx,tx]×[sy,ty]の内部(周上を含む)に存在する点を列挙できる。</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;クエリ２ ... 点(x,y)から、与えられた点のうち最も近いものへの距離を計算できる。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;addPointで点を与える(頂点を追加する)。ただし、追加した後はbuildをしないといけないので、高速ではない。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;buildで木を構築する。</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;Rootは全体の根で、大事なので書き換えたりしてわからなくならないように気を付けてください。</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;find_included_points : クエリ１</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;find_nearest_dist : クエリ２</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">*/</font></li>
                    <li style="background-color:#EEF;">template&lt;class T&gt;</li>
                    <li style="background-color:#EFF;">class kdTree{</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;クラス内で使う構造体。クラス外からもアクセス可能</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------    </li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;struct Point{</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T x , y;<font style="color:green;font-style:italic;">//座標</font></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifer : この点がどの点かを判断する</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kDtreeでは点をソートしたりするので、どの点がどこに行ったのかごちゃごちゃになりやすい。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;なので、点にidを与えることで、どこにどの点があるのかを判断する。</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font>  </li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int id;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point(T x_ , T y_ , int id_){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = x_;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = y_;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id = id_;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point(){}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;};</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;struct Node{</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node *left , *right ;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point val;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node(Node *left_ , Node *right_ , Point val_){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left = left_;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right = right_;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val = val_;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node(){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left = nullptr;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right = nullptr;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;};</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;private:</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;クラス内で行う処理。目には見えないブラックボックスってやつ</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------    </li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;int demension = 2;<font style="color:green;font-style:italic;">//次元。高くなると遅くなるよ</font></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//x座標で大小比較</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;static bool compX(Point a , Point b){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return a.x &lt; b.x;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//y座標で大小比較</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;static bool compY(Point a , Point b){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return a.y &lt; b.y;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_listを元に木を作る。</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[lef,rig) の区間に対応する部分木の根を作る。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;Node *build_sub(int lef = 0, int rig = 1e9 , int depth = 0){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(rig &gt;= P_list.size())rig = P_list.size();</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(lef&lt; 0)lef = 0;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(lef&gt;=rig){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return nullptr;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int mid = (lef+rig)/2;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//depth(階層)によってソートする座標軸を変える。二次元なので２通り</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(depth%2==1){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(P_list.begin()+ lef , P_list.begin() + rig , compX);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(P_list.begin()+ lef , P_list.begin() + rig , compY);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new Node(build_sub(lef,mid ,depth+1) , build_sub(mid+1 ,rig , depth+1) , P_list[mid]);</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;点(x,y)から、一番近い点の距離(の二乗)を求める</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;T find_nearest_dist_sub(T x, T y,  int depth, Node *nd , T r = -1 ) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd == nullptr) return r;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point p = nd-&gt;val;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T d = (x - p.x)*(x - p.x) + (y - p.y)*(y - p.y);</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(r == -1 || d &lt; r) r = d;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;階層によって、座標軸が違うので場合分け</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(depth % 2) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*      </li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;なんかとりあえず二分探索みたいなことをする</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;left != nullptr &amp;&amp; x - r &lt;= p.x) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = find_nearest_dist_sub(x, y,  depth+1 , nd-&gt;left , r);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;right != nullptr &amp;&amp; p.x &lt;= x + r) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = find_nearest_dist_sub(x, y,  depth+1 , nd-&gt;right , r);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;left != nullptr &amp;&amp; y - r &lt;= p.y) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = find_nearest_dist_sub(x, y,  depth+1 , nd-&gt;left , r);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;right != nullptr &amp;&amp; p.y &lt;= y + r) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = find_nearest_dist_sub(x, y,  depth+1 , nd-&gt;right , r);  </li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return r;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;矩形:[(sx,sy) , (tx,ty)]に含まれる点のidを,found_Points_IDに入れていく</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void find_included_points_sub(Node *nd, T sx, T tx, T sy, T ty, int depth) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point p = nd-&gt;val;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(sx&gt;tx)swap(sx,tx);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(sy&gt;ty)swap(sy,ty);</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(sx &lt;= p.x &amp;&amp; p.x &lt;= tx &amp;&amp; sy &lt;= p.y &amp;&amp; p.y &lt;= ty) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found_Points.push_back(p);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(depth % 2) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;left != nullptr &amp;&amp; sx &lt;= p.x) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_points_sub(nd-&gt;left, sx, tx, sy, ty, depth+1);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;right != nullptr &amp;&amp; p.x &lt;= tx) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_points_sub(nd-&gt;right, sx, tx, sy, ty, depth+1);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;left != nullptr &amp;&amp; sy &lt;= p.y) {</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_points_sub(nd-&gt;left, sx, tx, sy, ty, depth+1);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nd-&gt;right != nullptr &amp;&amp; p.y &lt;= ty) {</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_points_sub(nd-&gt;right,  sx, tx, sy, ty, depth+1);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;クラス外で行う処理。</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------    </li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------------------------------------------------------------------------------------------------------------</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//全体の根,記憶しておくこと。どっかになくしたらだめ</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;Node *Root = nullptr;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addPointでPointを追加していく。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ただし、追加した後はbuildで木を構築しないといけないので、追加はO(n)</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;Point&gt; P_list;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_pointsで取得した点を入れる配列</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;Point&gt; found_Points;</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//コンストラクタ</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;kdTree(){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pointを追加。ただし、追加した後に木を構築しないといけないので、O(n)</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;また、次元は適宜変えてください。</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void addPoint(T x , T y){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int id_ = P_list.size();</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_list.push_back(Point(x,y,id_));</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;build_subを使い、Rootを求める</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;void build(){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = nullptr;<font style="color:green;font-style:italic;">//前の情報が残っていたらなんか嫌だから</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = build_sub();</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;点(x,y)から、一番近い点の距離(の二乗)を求める</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;T find_nearest_dist(T x ,T y){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return find_nearest_dist_sub(x,y,0,Root,-1);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;矩形:[(sx,sy) , (tx,ty)]に含まれる点のidを,found_Points_IDに入れていく</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;引数は(sx , tx , sy , ty)なので注意</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void find_included_points(T sx , T tx ,T sy , T ty){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;Point&gt;(0).swap(found_Points);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_included_points_sub(Root , sx ,tx , sy , ty , 0);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">};</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">int main(){</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;kdTree&lt;long long&gt; K;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;int n;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;cin &gt;&gt; n;</li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;for(int i = 0 ; i &lt; n ;i++ ){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long long x , y;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin &gt;&gt; x &gt;&gt; y;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K.addPoint(x,y);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;K.build();</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int q;cin &gt;&gt; q;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;while(q--&gt;0){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long long sx,sy,tx,ty;</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin &gt;&gt; sx &gt;&gt; tx &gt;&gt; sy &gt;&gt; ty;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K.find_included_points(sx,tx,sy,ty);</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priority_queue&lt;int , vector&lt;int&gt; ,greater&lt;int&gt; &gt;pq;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(kdTree&lt;long long&gt;::Point p : K.found_Points){</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pq.push(p.id);</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(pq.size()&gt;0){</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<font style="color:brown;">"%d\n"</font> , pq.top());</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pq.pop();</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout &lt;&lt; endl;</li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;"></li>
                    <li style="background-color:#EEF;"></li>
                    <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                    <li style="background-color:#EEF;">}</li>
                    </ol>
                </code>
                






                
            </section>



        </div>



    </body>


</html>
