<!doctype html>
<html lang="ja">
    <link rel="stylesheet" media="screen and (max-width:768px)" href="./../../css/sp_style.css">    
    <link rel="stylesheet" media="screen and (min-width:769px)" href="./../../css/pc_style.css">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    </script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" }},
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
        },
        "HTML-CSS": { matchFontHeight: false },
        displayAlign: "left",
        displayIndent: "2em"
    });
    </script>
    <title>Problem_3</title>
        

    </head>




    <body>
        
         <!--軽くコメント-->
        <div id="Inner">
            <h_middle style = "text-align: left;"><a href="../../index.html">前のページ</a> </h_middle>
            <section class = "Introduction">
                
                <h_big>   
                    作問(3)<br></h_big>


            </section>


            <section class = "Explanation">

                <br><h_big>問題:NokonoKotlin Filters</h_big>
                <br>あなたは N 個の長方形を持っており、i 番目の長方形は、縦幅が h[i] , 横幅が w[i] です。
                <br>縦、横がそれぞれ H , W である長方形を食べることができるのは、口のサイズが縦 H 以上、横 W 以上の亀さんだけです。
                <br>また、長方形を食べた時に得られる満腹度は H × W です。
                <br>
                <br>Q匹の亀さんについて、それぞれの口のサイズ : H W が与えられるので、それぞれの亀さんが食べることのできる長方形を全て食べた時に得られる満腹度の総和を計算してください。
                
                <br>
                <br>なお、それぞれのクエリは独立である。つまり、ある亀さんが食べた長方形は、次のクエリでは復活する。
                <br>
                <br>
                
                
                <br>制約:0 &lt; N , Q , H , W , h[i] , w[i] &lt;= 100000 ,
                <br>
                <br>入力: 一行目に整数 N , 続く N 行には h[i] , w[i] が与えられ、N+2 行目に Q , 続く Q 行に クエリ : "H W" が与えられる。
                <br>
                <br>
                <section class="Box">

                    <!-- 解説パート ...　長い-->
                    <div id = "ProblemExplanation" style="display: none;">
                        <center><input type="button"  id="Button_hide" class = "button_black" onclick="HideButton()"  value = "解説を隠す"></center>
                        

                        <br>まずは前提知識を少し。
                        <br>
                        <br>今回は少し変わったセグメントツリーを書きます
                        <br>以下の図をご覧ください。
                        <br>
                        <br><img src = "./../../images/seg_and_splay.001.jpeg">
                        <br>
                        <br>このセグ木の場合、{4,2,1,2}という数列をセグメントツリーで管理しており、各頂点は対応する区間に対して、元の数列[4,2,1,2]の連続部分列を昇順ソートした数列を持っています。
                        <br>また、セグメントツリーは高さが logN で、ある層の頂点が持つ数列の長さの和は N なので、空間計算量は(NlogN)です。
                        <br>
                        <br>こういったセグメントツリーでは、与えられた区間 : [ l , r )  に対して、x 以下の個数を求めるなどといった操作を行うことができます。
                        <br>
                        <br>やり方は他のセグ木と同じで、まずは [ l , r ) に対応する頂点たちを見つけ、それらが持つ数列全てに対して、x 以下の要素の個数を計算するというものです。
                        <br>
                        <br>例えば、数列{4,2,1,2} に対して、0-index の[ 0 , 3 ) の区間の 2 以下の要素の個数を求めたい場合、[0,2) に対応した頂点と [2,3)に対応した頂点をみると良いです。
                        <br>それぞれの頂点は、{2,4} , {1} という数列を持っているので、それらの数列を二分探索することで、2以下の要素は 2 個であることがわかります。
                        <br>
                        <br>[ l , r ) に対応する頂点それぞれの持つ数列のサイズの和は、木の深さを y とすると最大で 2^0 + 2^1 + 2^2 + ... + 2^(y-2) なので、それぞれに対して二分探索を行って x 以下の要素の個数を計算すると、
                        <br>log(2^0) + log(2^1) + log(2^2) + ... + log(2^(y-2)) = log(2^((y-1*(y-2)/2)))  = (y-1)*(y-2)/2 回の計算が必要になります。y は 木の深さ(logN)であった事から、クエリの計算量はO((logN)^2)となります。
                        <br>
                        <br>
                        <br>また、各頂点に、対応する区間の平衡二分木を持たせておくことで、値の変更などにも対応することができます。
                        <br>
                        <br><h_big><Orange>本題</Orange></h_big>
                        <br>
                        <br>今回の問題でも、上記のセグメントツリーの各頂点に MultiSetタイプで(Key,Value)を持つSplayTreeを持たせます。このMultisetは<a href = "./Splay_4.html">こちらの解説</a>のものです。
                        <br>
                        <br>
                        <br>さて今回の問題ですが、要するに『 幅が W 以下、縦の長さが H 以下の長方形の面積の総和 』というのは セグメントツリーの元の数列に、W が小さい順にpair(H,W*H)を持たせ、『元の数列の、W以下の要素の個数』をind_w とした時、<Orange>『 [0 , ind_w ] の区間に対応する頂点のSplayTreeから、Key が [ 0 , H ] の区間の、Value の区間和を求める 』</Orange> と言い換えることができます。
                        <br>
                        <br>要するに、横幅が W 以下のものをSplayTreeで列挙して、さらにそこから H 以下のものの面積だけを加算するという操作になります。
                        <br>W 以下の長方形をSplayTreeで列挙する部分はセグメントツリーで効率よく可能で、
                        <br>H 以下の長方形の面積を加算するのはSplayTreeで効率よく計算可能です。
                        <br>
                        <br>
                        <br>以下はコード例になります(未verifiedです)。
                        <br>
                        <br>
                        <br>
                        <code>
                            <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;width:90%; line-height: 14px; color:#000;font-size:12px;">
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//include</font></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EFF;">#include &lt;vector&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;list&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;map&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;set&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;deque&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;stack&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;bitset&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;algorithm&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;functional&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;numeric&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;utility&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;sstream&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;iostream&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;iomanip&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;cstdio&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;cmath&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;cstdlib&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;cctype&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;string&gt;</li>
                            <li style="background-color:#EEF;">#include &lt;cstring&gt;</li>
                            <li style="background-color:#EFF;">#include &lt;ctime&gt;</li>
                            <li style="background-color:#EEF;">#include&lt;queue&gt;</li>
                            <li style="background-color:#EFF;">#include&lt;complex&gt;</li>
                            <li style="background-color:#EEF;">using namespace std;</li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//conversion</font></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EFF;">inline long long toint(string s) {long long v; istringstream sin(s);sin&gt;&gt;v;return v;}</li>
                            <li style="background-color:#EEF;">template&lt;class T&gt; inline string toString(T x) {ostringstream sout;sout&lt;&lt;x;return sout.str();}</li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//math</font></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//-------------------------------------------</font></li>
                            <li style="background-color:#EFF;">template&lt;class T&gt; inline T sqr(T x) {return x*x;}</li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//typedef</font></li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EEF;">typedef long long ll;</li>
                            <li style="background-color:#EFF;">typedef long long LL;</li>
                            <li style="background-color:#EEF;">typedef vector&lt;int &gt; vi;</li>
                            <li style="background-color:#EFF;">typedef vector&lt;long long &gt; VLL;</li>
                            <li style="background-color:#EEF;">typedef vector&lt;long long &gt; vll;</li>
                            <li style="background-color:#EFF;">typedef vector&lt;string &gt; ves;</li>
                            <li style="background-color:#EEF;">typedef vector&lt;char &gt; vech;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">typedef pair&lt;long long , long long&gt; pll;</li>
                            <li style="background-color:#EFF;">typedef pair&lt;long long , long long&gt; PLL;</li>
                            <li style="background-color:#EEF;">typedef map&lt;ll , ll &gt;mll;</li>
                            <li style="background-color:#EFF;">typedef map&lt;int , int &gt;mii;</li>
                            <li style="background-color:#EEF;">typedef map&lt;char , int &gt;mci;</li>
                            <li style="background-color:#EFF;">typedef map&lt;char , ll &gt;mcl;</li>
                            <li style="background-color:#EEF;">typedef vector&lt;pair&lt;ll , ll&gt; &gt; vpll;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//container util</font></li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EEF;">#define ALL(a)  (a).begin(),(a).end()</li>
                            <li style="background-color:#EFF;">#define RALL(a) (a).rbegin(), (a).rend()</li>
                            <li style="background-color:#EEF;">#define VECMAX(x) *max_element(ALL(x))</li>
                            <li style="background-color:#EFF;">#define VECMIN(x) *min_element(ALL(x))</li>
                            <li style="background-color:#EEF;">#define PB push_back</li>
                            <li style="background-color:#EFF;">#define MP make_pair</li>
                            <li style="background-color:#EEF;">#define SZ(a) int((a).size())</li>
                            <li style="background-color:#EFF;">#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)</li>
                            <li style="background-color:#EEF;">#define EXIST(s,e) ((s).find(e)!=(s).end())</li>
                            <li style="background-color:#EFF;">#define SORT(c) sort((c).begin(),(c).end())</li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//repetition</font></li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EEF;">#define FOR(i,a,b) for(long long i=(a);i&lt;(b);++i)</li>
                            <li style="background-color:#EFF;">#define REP(i,n)  FOR(i,0,n)</li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//#define MULTIPLE(i,n,k) for(int i = (k) ; i&lt;(n) ; i+=k+1)//倍数ループ</font></li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//constant</font></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">//------------------------------------------</font></li>
                            <li style="background-color:#EFF;">const double EPS = 1e-10;</li>
                            <li style="background-color:#EEF;">const double PI  = acos(-1.0);</li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//clear memory</font></li>
                            <li style="background-color:#EEF;">#define CLR(a) memset((a), 0 ,sizeof(a))</li>
                            <li style="background-color:#EFF;"><font style="color:green;font-style:italic;">//debug</font></li>
                            <li style="background-color:#EEF;">#define dump(x)  cerr &lt;&lt; #x &lt;&lt; <font style="color:brown;">" = "</font> &lt;&lt; (x) &lt;&lt; endl;</li>
                            <li style="background-color:#EFF;">#define debug(x) cerr &lt;&lt; #x &lt;&lt; <font style="color:brown;">" = "</font> &lt;&lt; (x) &lt;&lt; <font style="color:brown;">" (L"</font> &lt;&lt; __LINE__ &lt;&lt; <font style="color:brown;">")"</font> &lt;&lt; <font style="color:brown;">" "</font> &lt;&lt; __FILE__ &lt;&lt; endl;</li>
                            <li style="background-color:#EEF;">#define SIZEOF(x) sizeof(x)/sizeof(x[0])</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">const long long INF = 4e18;</li>
                            <li style="background-color:#EEF;">const long long NINF = 1 - INF;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;splitした後はmergeを忘れずに！！(それかSplitした頂点のrootを覚えておこう)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;頂点にアクセスしたら、その頂点をsplayするのを忘れるな！！</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;頂点をいじったらsplayの後、Updateするのを忘れないで</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNodeにはKeyとValue(その他自由に追加していい)を持たせており、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;Keyの大小関係をもとに昇順に並んでいる。</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;Keyが同じ部分では,Valueの大小関係をもとに昇順に並んでいる。</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;具体的には、以下のような評価のもとに並んでいる</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNodeの比較関数</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaEqual(a,b,type) : a == bかどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Smaller(a,b,type) : a &lt;= bかどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node a, bに関して　Keyのみ比較はKeyの大層関係のみ(a &lt; b ... a-&gt;Key &lt; b-&gt;Key);</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node a , bに関して (Key , Value)の比較では、以下の通り</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a-&gt;Key &lt; b-&gt;Key の時　: a &lt; b</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a-&gt;Key==b-&gt;Keyかつ、 a-&gt;Value&lt;= b-&gt;Value の時：　a&lt;=b</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;そうでない時：a&gt;b</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;erase(x)ではKey = xであるような頂点を一つ削除する(Valueについては指定していないので、どれが消えるかわからない)</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;erase(x,y)では(key,val)を持つ頂点を一つ削除する</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;Nodeの持つValueについて、RangeMinQuery_val ,RangeMaxQuery_val ,RangeSumQuery_Value ができる。</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;また、NodeのKeyについてもRangeSumQuery_Keyができる。</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">*/</font></li>
                            <li style="background-color:#EEF;">template&lt;class T , class T2&gt;</li>
                            <li style="background-color:#EFF;">class MyMultiSet2{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayTreeの、Nodeのデータ構造。</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayTreeでは、Glaphの配列上で操作のやり取りをするのではなく、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNodeというデータ構造に持たせたデータでやり取りをする</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------   </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;struct SplayNode{</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *parent = nullptr;<font style="color:green;font-style:italic;">//親ノード</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *left = nullptr;<font style="color:green;font-style:italic;">//左の子ノード</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *right = nullptr;<font style="color:green;font-style:italic;">//右の子ノード</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T Key;<font style="color:green;font-style:italic;">//値(この値をもとに昇順に並んでいる)</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T2 Value;<font style="color:green;font-style:italic;">//Keyとは別に頂点に持たせる値(Keyと型が違う可能性もあるので、T2)</font></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T Sum_key;<font style="color:green;font-style:italic;">//部分木のうち、Keyの値の和</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T2 Min_val,Max_val,Sum_val;<font style="color:green;font-style:italic;">//部分木のうち、Valueの値の最大、最小、和</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int SubTreeSize = 1;<font style="color:green;font-style:italic;">//1は初期化値(自分自身)</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode(){}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode(T key_){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//Valueが与えられなかった場合、valueはKeyの値で初期化</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key = key_;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sum_key = Key;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value = Key;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Min_val = Value;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Max_val = Value;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sum_val = Value;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode(T key_ , T2 val_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key = key_;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sum_key = Key;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value = val_;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Min_val = Value;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Max_val = Value;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sum_val = Value;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool isExist(SplayNode *Nd){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Nd!=nullptr)return true;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else return false;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ある地点を回転させる</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void rotate(){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *Parent , *GrandParent , *Child;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent = this-&gt;parent;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GrandParent = Parent-&gt;parent;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Child = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(Parent) == false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//元の親に対する位置で場合分け</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Parent-&gt;left == this){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Child = this-&gt;right;<font style="color:green;font-style:italic;">//Childはnullptrかもしれない</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;right = Parent;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent-&gt;left = Child;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(Parent-&gt;right == this){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Child = this-&gt;left;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;left = Parent;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent-&gt;right = Child;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(GrandParent)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//GrandParentのどちらの辺なのかで場合分け</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Parent == GrandParent-&gt;left){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GrandParent-&gt;left = this;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(Parent == GrandParent-&gt;right){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GrandParent-&gt;right = this;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//GrandParentがnullptrの場合でも代入OK</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;parent = GrandParent;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//親と位置を入れ替えるので</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent-&gt;parent = this;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//Childは移動するので。</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(Child))Child-&gt;parent = Parent;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nodeの持つ情報をupdateしないといけないが、順番に注意！！</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChildはChild以下の部分木が変化してないので何もしなくてOK</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GrandParentは、部分木の中の順番が変わったけど、集合としては変わってないので何もしなくてOK</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parentと自分自身(this)は順番が変わって、部分木の内容も変わったので、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下から　Parent　?  this の順番でupdateする</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自分の親から見た自分の位置</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 -&gt; 親がそもそもいない or 例外の場合</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 -&gt; 親から見て左の子の場合</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 -&gt; 親から見て右の子の場合 </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int state(){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(this-&gt;parent)== false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this-&gt;parent-&gt;left == this){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(this-&gt;parent-&gt;right == this){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 2;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else {</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;あるNodeを回転を駆使し一番上まで持っていく</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;この時、回転する順番に注意</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void splay(){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(isExist(this-&gt;parent)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(this-&gt;parent-&gt;parent)==false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//(自分のGrandParentがいない場合、rotateは一回のみ)</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;rotate();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//それ以外の場合、(自分、親、親の親)の位置関係が大事</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(this-&gt;state() == this-&gt;parent-&gt;state()){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//GrandParentからの道が(右、右)or (左、左)の場合</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//GrandParentを一つ下に下ろして、自分を上げる</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;parent-&gt;rotate();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;rotate();</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//それ以外の場合、単純に自分を2回上に上げれば良い</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;rotate();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;rotate();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}   </li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;サイズなど、Nodeの持っている情報をupdateする(順番大事)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void update(){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(this) == false)return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;SubTreeSize = 1;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_key = this-&gt;Key;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_val = this-&gt;Value;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Min_val = this-&gt;Value;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Max_val = this-&gt;Value;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(this-&gt;left)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;SubTreeSize += this-&gt;left-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this-&gt;left-&gt;Min_val &lt; this-&gt;Min_val)this-&gt;Min_val = this-&gt;left-&gt;Min_val;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this-&gt;left-&gt;Max_val &gt; this-&gt;Max_val)this-&gt;Max_val = this-&gt;left-&gt;Max_val;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_key += this-&gt;left-&gt;Sum_key;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_val += this-&gt;left-&gt;Sum_val;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(this-&gt;right)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;SubTreeSize += this-&gt;right-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this-&gt;right-&gt;Min_val &lt; this-&gt;Min_val)this-&gt;Min_val = this-&gt;right-&gt;Min_val;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this-&gt;right-&gt;Max_val &gt; this-&gt;Max_val)this-&gt;Max_val = this-&gt;right-&gt;Max_val;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_key += this-&gt;right-&gt;Sum_key;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;Sum_val += this-&gt;right-&gt;Sum_val;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;};</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ここからやっとSplayTreeに載せる関数たちの出番</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木において、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split(ind,root) , merge(l_root, r_root) , delete_sub(ind,root) , insert_sub()　など</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;これらは主にclass内で使われる。</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classの外で使う関数として、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delete , insert, RangeSumQuery , shiftなどが想定される</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------   </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//これは、Nodeを管理する配列のサイズで、木のサイズではない(変更しないので、あらかじめ大きめにとっておく)</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int Size = 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//この木のroot,splitした後はmergeして戻す！！rootが迷子にならないように！！</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *Root = nullptr;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;MyMultiSet2(){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;MyMultiSet2(int size_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;bool isExist(SplayNode *Nd){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Nd==nullptr){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ここからは、クラス内で動かす関数たちです。俗にいうブラックボックスです。</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;private:</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNodeの比較関数</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaEqual(a,b,type) : a == bかどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Smaller(a,b,type) : a &lt;= bかどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node a, bに関して　Keyのみ比較はKeyの大層関係のみ(a &lt; b ... a-&gt;Key &lt; b-&gt;Key);</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Node a , bに関して (Key , Value)の比較では、以下の通り</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a-&gt;Key &lt; b-&gt;Key の時　: a &lt; b</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a-&gt;Key==b-&gt;Keyかつ、 a-&gt;Value&lt;= b-&gt;Value の時：　a&lt;=b</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;そうでない時：a&gt;b</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//Node a , bが等しいかどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;bool isEqual(SplayNode *a , SplayNode *b , int type = 0){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(type == 0 )return a-&gt;Key == b-&gt;Key;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else return (a-&gt;Key == b-&gt;Key) &amp;&amp; (a-&gt;Value == b-&gt;Value);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//Node a , bに関して a &lt;= b かどうか...type == 0ならKeyのみの比較。そうでないなら(Key,Value)の比較</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;bool isSmaller(SplayNode *a , SplayNode *b , int type = 0){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(type == 0)return a-&gt;Key &lt;= b-&gt;Key;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(a-&gt;Key &lt; b-&gt;Key)return true;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(a-&gt;Key == b-&gt;Key){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(a-&gt;Value &lt;= b-&gt; Value)return true;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else return false;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else return false;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木において、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexを左からの0-indexとすると、</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;求めたいindexになるまで降りていく</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *getNode(int index , SplayNode *root){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root)==false)return root;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *now = root;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(1){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int left_size = 0;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_size = now-&gt;left-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(index &lt; left_size){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;left;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(index == left_size){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;splay();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(index &gt; left_size){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;right;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index = index - left_size-1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return now;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;それぞれ、leftrootとrightrootが根であるような部分木をくっつける</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splitした後、これをしてまたsplitしたものをくっつける</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splitしたまま放置すると分割された木のrootが行方不明になりそう</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *merge(SplayNode *leftRoot , SplayNode *rightRoot){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(leftRoot) == false)return rightRoot;<font style="color:green;font-style:italic;">//右のみあり</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(rightRoot) == false )return leftRoot;<font style="color:green;font-style:italic;">//左のみあり</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot = getNode(leftRoot-&gt;SubTreeSize-1 , leftRoot);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot-&gt;right = rightRoot;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot-&gt;parent = leftRoot;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return leftRoot;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木において、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;左からleftnum番目の頂点で左右にsplit。</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splitした後はmergeしないと,splitした木の頂点が行方不明になりそう</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt; split(int leftnum, SplayNode *root){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(leftnum&lt;=0)return std::make_pair(nullptr , root);</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(leftnum &gt;= root-&gt;SubTreeSize)return std::make_pair(root, nullptr);</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = getNode(leftnum , root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot , *rightRoot;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot = root-&gt;left; </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot = root; </li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(rightRoot))rightRoot-&gt;left = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(leftRoot))leftRoot-&gt;parent = nullptr; </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(leftRoot,rightRoot);</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木において、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexの場所を切り離して、NODEを追加して元に戻す(merge)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODEについて、Keyについて昇順で並べ、Keyが同じであるようなものについてはValueで昇順で並べる</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(比較関数のtype:1挿入する)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode  *insert_sub( SplayNode *NODE , SplayNode *root){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root) == false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root=NODE;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size=1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return root;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *now = root;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(true){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isSmaller(now , NODE , 1)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right) == false){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;right = NODE;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODE-&gt;parent = now;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;right;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left) == false){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;left = NODE;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODE-&gt;parent = now;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;left;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size++;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;splay();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return now;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*  </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木において、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;左からindexの場所を削除して、両端をくっつける</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstは消したやつ以外をmergeした時のroot</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secondは消したSplayNode</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt; Delete_sub(int index , SplayNode *root){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root) == false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(root,root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(index&lt;0 || index &gt;= Size){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(root,root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Size == 1){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size = 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(nullptr,nullptr);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = getNode(index,root);</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot = root-&gt;left;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *rightRoot = root-&gt;right;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(leftRoot))leftRoot-&gt;parent = nullptr;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(rightRoot))rightRoot-&gt;parent = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;left = nullptr;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;right = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size--;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(merge(leftRoot,rightRoot) , root );</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木の[l,r)区間を削除</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode* RangeDelete_sub(int l , int r , SplayNode *root){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot , *centerRoot , *rightRoot; </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r--;<font style="color:green;font-style:italic;">//半開区間なので</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt;  tmp = split(r+1,root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot = tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp = split(l,tmp.first);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centerRoot = tmp.second;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size-=centerRoot-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return merge(leftRoot,rightRoot);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODEと同じ値(Key,value)をもつ要素をpop。</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ただし、比較演算のtype==0でKeyのみに関して検索 , </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type != 0 で(Key , Value)に関して検索</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt; erase_sub(SplayNode *NODE , SplayNode *root , int type = 0){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root)==false){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(root,root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *now = root;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(true){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now)==false){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//そもそもNODE.Keyと同じKeyを持つ頂点がなかった時</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//何もせず終了</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(root,root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isEqual(now,NODE,type)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(!isSmaller(now,NODE,type)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;left;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;right;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = now;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;splay();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot = root-&gt;left;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *rightRoot = root-&gt;right;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(leftRoot))leftRoot-&gt;parent = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(rightRoot))rightRoot-&gt;parent = nullptr;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;left = nullptr;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root-&gt;right = nullptr;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size--;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(merge(leftRoot,rightRoot) , root );</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木の[l,r)の区間取得クエリ</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyの区間和クエリ</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T&gt; RangeSumQuery_key_sub(int l , int r , SplayNode *root){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot , *centerRoot , *rightRoot; </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r--;<font style="color:green;font-style:italic;">//半開区間なので</font></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt;  tmp = split(r+1,root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot = tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp = split(l,tmp.first);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centerRoot = tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T ans = centerRoot-&gt;Sum_key;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(merge(merge(leftRoot,centerRoot),rightRoot),ans);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootを根とする部分木の[l,r)の区間取得クエリ</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;区間内のvalに関して、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_type = 0 ... 区間Min</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_type = 1 ... 区間Max</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_type = 2(else) ... 区間Sum</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T2&gt; RangeQuery_val_sub(int l , int r , int q_type , SplayNode *root){</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *leftRoot , *centerRoot , *rightRoot; </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r--;<font style="color:green;font-style:italic;">//半開区間なので</font></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt;  tmp = split(r+1,root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rightRoot = tmp.second;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp = split(l,tmp.first);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leftRoot = tmp.first;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centerRoot = tmp.second;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T2 ans;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(q_type == 0)ans = centerRoot-&gt;Min_val;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(q_type == 1)ans = centerRoot-&gt;Max_val;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else ans = centerRoot-&gt;Sum_val;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(merge(merge(leftRoot,centerRoot),rightRoot),ans);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *NODEが与えられる</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootが根であるような部分木の頂点のうち、</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type = 0 : a-&gt;Key &lt; NODE-&gt;Key であるような頂点の個数を返す</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type != 0 : (Key,Value)に関して、a &lt; NODEであるような頂点の個数を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; lower_bound_sub(SplayNode *NODE , SplayNode *root ,int type = 0){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root) == false)return std::make_pair(root,0);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *now = root;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int res = root-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right))res -= now-&gt;right-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(true){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isSmaller(now,NODE,type) || isEqual(now,NODE,type)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;left;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res-=1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right))res-=now-&gt;right-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res--;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;right;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left))res+=now-&gt;left-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;splay();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(now , res);</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *NODEが与えられる</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootが根であるような部分木の頂点のうち、</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type = 0 : a-&gt;Key &lt; NODE-&gt;Key であるような頂点の個数を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type != 0 : (Key,Value)に関して、a &lt; NODEであるような頂点の個数を返す</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; upper_bound_sub(SplayNode *NODE , SplayNode *root ,int type = 0){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(root) == false)return std::make_pair(root,0);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SplayNode *now = root;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int res = root-&gt;SubTreeSize;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right))res -= now-&gt;right-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(true){</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isSmaller(now,NODE,type)){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;left;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res-=1;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right))res-=now-&gt;right-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res--;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;right)){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now = now-&gt;right;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res+=1;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(now-&gt;left))res+=now-&gt;left-&gt;SubTreeSize;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now-&gt;splay();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return std::make_pair(now , res);</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ここからは、クラスの外で動かす関数たちです。</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;木全体のindex番目のNode(値渡し)を取得</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SplayNode get(int index){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(index&lt;0 || index&gt;=Size){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt; <font style="color:brown;">"index exceeds Size"</font> &lt;&lt; std::endl;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return SplayNode(0,0);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = getNode(index,Root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return *(Root);</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyのみを指定して挿入(ValueはKeyと同じ値で初期化される)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;両方指定することも可能</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void insert( T key_ ){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = insert_sub(new SplayNode(key_) ,Root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyとValueを指定して挿入    </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;void insert( T key_ , T2 val_){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = insert_sub(new SplayNode(key_ , val_) ,Root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyが小さい順でi番目( iは0-indexed )の頂点のValueを val_ にする</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i番目のNodeを更新後、そのNodeがi番目とは限らない(Valueで昇順に再配置するから)</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;void update_val(int i , T2 val_){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T key_ = get(i).Key;      </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delete(i);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert(key_,val_);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index番目のNodeを消去</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void Delete(int index){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,SplayNode*&gt; tmp = Delete_sub(index,Root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isExist(Root) == false )return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[lef,rig)に対応する区間を全削除</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;void RangeDelete(int lef , int rig){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lef = max(0,lef);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rig = min(rig,Size);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(lef&gt;=rig){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr &lt;&lt; <font style="color:brown;">"right must be larger than left "</font> &lt;&lt; endl;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = RangeDelete_sub(lef,rig,Root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyとして、key_を持つ頂点を一つpop。ただし、Valueについては指定しない</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void erase(T key_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = erase_sub(new SplayNode(key_) , Root,0).first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(key_,val_)を持つ頂点を一つ削除</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void erase(T key_ , T2 val_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = erase_sub(new SplayNode(key_,val_) , Root,1).first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key == key_である頂点を全削除</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void erase_multi(T key_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int lef = lower_bound(key_);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int rig = upper_bound(key_);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(lef&gt;=rig)return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RangeDelete(lef,rig);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key == key_かつValue = val_である頂点を全削除</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void erase_multi(T key_ , T2 val_){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int lef = lower_bound_pair(key_,val_);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int rig = upper_bound_pair(key_,val_);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(lef&gt;=rig)return;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RangeDelete(lef,rig);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小さい方からl番目以上、r番目未満の頂点のKeyの和</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;T RangeSumQuery_key(int l , int r){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l = max(0,l);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = min(Size,r);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(l&gt;=r){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr &lt;&lt; <font style="color:brown;">"right must be larger than left "</font> &lt;&lt; endl;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T&gt; tmp = RangeSumQuery_key_sub(l,r,Root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小さい方からl番目以上、r番目未満の頂点のValueのMin</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;T2 RangeMinQuery_val(int l , int r){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l = max(0,l);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = min(Size,r);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(l&gt;=r){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr &lt;&lt; <font style="color:brown;">"right must be larger than left "</font> &lt;&lt; endl;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T2&gt; tmp = RangeQuery_val_sub(l,r,0,Root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小さい方からl番目以上、r番目未満の頂点のValueのMax</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;T2 RangeMaxQuery_val(int l , int r){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l = max(0,l);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = min(Size,r);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(l&gt;=r){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr &lt;&lt; <font style="color:brown;">"right must be larger than left "</font> &lt;&lt; endl;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T2&gt; tmp = RangeQuery_val_sub(l,r,1,Root);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小さい方からl番目以上、r番目未満の頂点のValueの和</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;T2 RangeSumQuery_val(int l , int r){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l = max(0,l);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = min(Size,r);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(l&gt;=r){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerr &lt;&lt; <font style="color:brown;">"right must be larger than left "</font> &lt;&lt; endl;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,T2&gt; tmp = RangeQuery_val_sub(l,r,2,Root);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyがx未満の頂点の個数を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int lower_bound(T x){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; tmp = lower_bound_sub(new SplayNode(x),Root,0);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Key , Value)に関して、a &lt; NODE(x,y)であるような頂点の個数を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int lower_bound_pair(T x , T2 y){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; tmp = lower_bound_sub(new SplayNode(x,y),Root,1);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyがx以下の頂点の個数を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int upper_bound(T x){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; tmp = upper_bound_sub(new SplayNode(x),Root,0);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Key , Value)に関して、a &lt;= NODE(x,y)であるような頂点の個数を返す</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;int upper_bound_pair(T x , T2 y){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::pair&lt;SplayNode*,int&gt; tmp = upper_bound_sub(new SplayNode(x,y),Root,1);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root = tmp.first;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root-&gt;update();</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return tmp.second;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key == xであるような頂点のindex(複数あるなら最初のもの)を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;なければ-1を返す</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;int find(T x){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(upper_bound(x) - lower_bound(x) &lt;= 0){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return lower_bound(x);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Key,Value) == (x,y)であるような頂点のindex(複数あるなら最初のもの)を返す</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;なければ-1を返す</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int find(T x , T2 y){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(upper_bound_pair(x,y) - lower_bound_pair(x,y) &lt;= 0){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return lower_bound_pair(x,y);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">/*</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一列に表示</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;*/</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;void Debug(){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt;<font style="color:brown;">"DEBUG: -- Size = "</font> &lt;&lt; Size &lt;&lt; std::endl;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( int i = 0 ; i &lt; Size ; i++){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt; get(i).Key &lt;&lt; <font style="color:brown;">" "</font>;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt; std::endl;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( int i = 0 ; i &lt; Size ; i++){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt; get(i).Value &lt;&lt; <font style="color:brown;">" "</font>;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cerr&lt;&lt; std::endl;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">};</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"><font style="color:green;font-style:italic;">/*  </li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">*/</font></li>
                            <li style="background-color:#EFF;">template&lt;class T&gt;</li>
                            <li style="background-color:#EEF;">class SegmentTree {</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;ll n;  <font style="color:green;font-style:italic;">// 最下段のノード数</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;const ll inf = 10000000000000000ll;<font style="color:green;font-style:italic;">//Tによって型を変える</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;MyMultiSet2&lt;ll,ll&gt; &gt; dat;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;T&gt; A;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;public:</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//vector&lt;ll&gt;を</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;SegmentTree(vector&lt;T&gt; a){</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=a;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n = a.size()*2+100;<font style="color:green;font-style:italic;">//余分に取る</font></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REP(i,n*2+1)dat.push_back(MyMultiSet2&lt;ll,ll&gt;());</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init(0 , 0 , n);<font style="color:green;font-style:italic;">//固定</font></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">// kは頂点の番号で、区間[l, r)に対応する</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;void init(int k, int l, int r ) {</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r - l == 1) { </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(l &lt; A.size())dat[k].insert(A[l].first , A[l].second);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else dat[k].insert(inf,inf);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int lch = k * 2 + 1;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int rch = k * 2 + 2; </li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init(lch, l, (l + r) / 2);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init(rch, (l + r) / 2, r); </li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REP(i,dat[lch].Size){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dat[k].insert(dat[lch].get(i).Key , dat[lch].get(i).Value);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REP(i,dat[rch].Size){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dat[k].insert(dat[rch].get(i).Key , dat[rch].get(i).Value);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">// 区間 [l, r) に対応する頂点(SplayTree)を取得し、クエリを処理する</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;int query_sub(int i, int j, ll x, int k  , int l  , int r) {</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (j &lt;= l || r &lt;= i) {<font style="color:green;font-style:italic;">// 完全に交差しない</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else if (i &lt;= l &amp;&amp; r &lt;= j) {<font style="color:green;font-style:italic;">// 完全に含まれる</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(dat[k].upper_bound(x) &lt;= 0)return 0;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else return dat[k].RangeSumQuery_val(0,dat[k].upper_bound(x));</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<font style="color:green;font-style:italic;">// 子について再帰的に求める </font></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int lc = query_sub(i, j, x, k * 2 + 1, l, (l + r) / 2);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int rc = query_sub(i, j,  x, k * 2 + 2, (l + r) / 2, r);</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return lc + rc;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;int query(int i , int j , ll x){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return query_sub(i , j , x , 0 , 0 , n);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">};</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">struct rectangle{</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;long long h , w;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;rectangle(){}</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;rectangle(ll h , ll w):h(h),w(w){}</li>
                            <li style="background-color:#EEF;">};</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">bool compare_by_width(rectangle a , rectangle b){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;return a.w &lt; b.w;</li>
                            <li style="background-color:#EFF;">}</li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">void solve(){</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;ll n , q;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;cin &gt;&gt; n &gt;&gt; q;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;rectangle&gt; v(n);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;REP(i,n)cin &gt;&gt; v[i].h &gt;&gt; v[i].w;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;sort(ALL(v),compare_by_width);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;vpll s;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;MyMultiSet2&lt;ll,int&gt; index;<font style="color:green;font-style:italic;">//sのうち、横幅が w 以下のものが何番目かを計算するために使う(sはv[i].wについて昇順にpushしていく)</font></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;REP(i,n){  </li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">//wについて昇順</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.push_back(MP(v[i].h , v[i].h*v[i].w));</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index.insert(v[i].w);</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;SegmentTree&lt;pair&lt;long long , long long &gt; &gt; S(s);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;REP(i,q){</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll ans = 0;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll H , W;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin &gt;&gt; H &gt;&gt; W;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">// 幅が W 以下のもののうち、高さが H 以下のものの面積の総和を求める</font></li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font style="color:green;font-style:italic;">// &lt;=&gt; 区間 [ 0 , W ] に対応した SplayTreeで、Keyが [ 0 , H ] の区間のValueの区間和を求める と言い換えできる</font></li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans += S.query(0,index.upper_bound(W) , H);</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout &lt;&lt; ans &lt;&lt; endl;</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;}</li>
                            <li style="background-color:#EEF;">}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;">int main(){</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
                            <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;solve();</li>
                            <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</li>
                            <li style="background-color:#EEF;">}</li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            <li style="background-color:#EFF;"></li>
                            <li style="background-color:#EEF;"></li>
                            </ol></code>


                        <br>
                        <br>
                        <br>
                        <br>


                        
                        <center><input type="button" id="Button_hide" class = "button_black" onclick="HideButton()" value = "解説を隠す"></center>
                    </div>
                    







                    <div id = "HideCheck" style="display: block;">
                        <center><input type="button"  id="Button_appear" class = "button_black" onclick="AppearButton()"  value = "解説を表示する"></center>
                    </div>

                    


                </section>





                
            </section>



        </div>



    </body>


</html>



<!--javascript partです-->
<!--javascript partです-->
<!--javascript partです-->
<!--javascript partです-->


<script>


    function AppearButton(){
        document.getElementById("ProblemExplanation").style.display = "block";
        document.getElementById("HideCheck").style.display = "none";
    }

    function HideButton(){
        document.getElementById("ProblemExplanation").style.display = "none";
        document.getElementById("HideCheck").style.display = "block";
    }
</script>