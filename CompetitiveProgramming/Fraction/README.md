# MyMath::Fraction 

有理数を表現するクラス。微少量や無限大もサポートする。

## ライセンス的なもの
ここのコードに関して、以下は許します。  
- 他人に共有しない場所で個人使用する。  
- このコードを使い、競技プログラミングの提出コードとして提出する(ただし、その提出を他者に共有するのは禁止)。  

以上 2 つ以外の用途は認めません。

## 概要

整数型 (__int128_t) の A ,B に対して A/B を表現 (普通にオーバーフローしやすいから注意。)
 
- 値を T 型で取り出したい場合は、val<T>() を呼び出す (T が整数なら切り捨てられた値になることもある)
- 生の値を取り出したい場合は、raw_pair() ( long long のペア ) を呼び出す 

### 設計 :
- 整数 -> Fraction のキャストは OK は暗黙
- Fraction -> なにか のキャストは明示的にする必要がある (演算子の重複を回避する)
    - 別のクラスのメンバ型として使う時、そのクラスのキャストはメンバ型のキャストを明示的にする必要がある
- 内部の値は __int128_t 型なので 分母/分子 が 64 bit 整数の範囲を超えなければ処理できる
- A/B の値が、{0 , 微少量 , 有理数 , 無限大/無限小 , 0/0 (曖昧) } のどれかで処理を分ける
    - A/B が有理数の場合、A/B は常に既約であるように設計 
        - 分母 B は常に正整数 0 より大きい)  とする
    - A/B が 0 or 微少量の際、(A,B) = (0,1) で統一し、eps_sign で分別する
    - A/B が無限大/無限小の場合、(A,B) = (符号 , 0) で統一する
    - A/B が曖昧の場合、(A,B) = (0,0) とする                
- 各演算の両辺は必ず整数 or Fraction。

### 仕様 : 
- 演算の規則は一般の数学の規則に準拠
- 0 で割った値は amb() = 0/0 になる。
- ただし、コンストラクタで明示的に分母が 0 の値を与えた場合、それは無限大/無限小 になる
- EX. 
    - Fraction(4)/0 → amb (0/0)
    - Fraction(9,0) = ∞ (1/0)
    - Fraction(-2,0) = -∞ (-1/0)
- -0 , 0 , +0 を区別する (特に、-0,+0 を微少量 -ε , ε と呼ぶ)
    - 0 徐算は amb になるが、-0 や +0 で割ったら無限大/無限小になる
    - 0 は何をかけても、0 以外の何で割っても 0 のまま
    - (+0) + (-0) は amb になる


## 実装

特殊な実装のみ簡潔に紹介

### 比較演算 <=> 
- <=> が返す less / greater / equivalent の結果から、< , <= , > , >= 演算の結果を作るすごいやつ
    - 例えば、0 <=> ∞ は less (<) を返す。すると、0 < ∞ が true になる < を作ってくれる。
- unordered について
    - a,b の順序比較ができない時、unordered を返す。(0/0 との比較など)
        - unordered な順序があるバブルソート
            - 全ての順序が true になるまで操作を続けるので、永遠に終わらない
    - ∞ と ∞ の比較なども本来は unordered だが、プログラム内部での違いがないので equivalent として OK
        - これによってバブルソート時にに ±0 や ±∞ は許容されるようになった。
        - 実際は異なることに注意!!!! (∞/∞ や 0/0 は 1 にはならない)
    - amb() の比較は unordered にせざるを得ない。
        - 例えばソートする列に amb() が混ざっていたら、amb() 以外も正しくソートされない
        - 可能な限り amb() の比較は避けよう

## 思想
無限大/無限小 , 微少量 を採用することで、今後 Stern–Brocot Tree などのアルゴリズムを採用しやすくなり、また幾何ライブラリなどに柔軟に対応することが期待できる。