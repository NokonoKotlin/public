# modlib

modint , FFT , FPS ライブラリ

参照する演算が複数存在するような状況を回避するため、modint と FPS のキャスト関係は作らない。


## ライセンス (license)
Copyright (c) 2024 NokonoKotlin
Released under the MIT license
https://opensource.org/licenses/mit-license.php


## NokonoKotlin のお気持ち
- 競プロの提出とかも、ここのコードを使っているなら著作者 (NokonoKotlin) を明記してほしいよ。
- ライブラリに組み込むのは自由だけど、自分のライブラリと称するのはやめてほしいよ。

## modint

- MOD つき整数。自動で mod をとってくれる。
- 基本的な演算は整数型と同じような設計にしてあり、整数型との演算も行える。
##### 設計
- 整数型 -> modint のキャストは暗黙
    - これにより、modint 同士の演算のみ定義しておけば、整数型との演算もカバーできる
- modint -> 整数型 のキャストは明示的
    - 参照する演算が複数存在するような状況を回避するため。
- 一応比較演算子も用意しておく (std::max,min,set などに使用できるように)
  

## FFT (FastFourierTransform)
- MOD 付きのフーリエ変換 & 畳み込み
- MOD は NTT-friendly な素数のみ
    - 998244353 の場合は列サイズが 2^23  まで OK


## FPS (Formal Power Series)
- 多項式を扱うクラス。
    - 係数は MOD 付き整数
- x^i の係数を A[i] と置く。この式は A.size()-1 次式である。

##### 設計 & 仕様
- 自身のメンバを変化させるので、const 参照はできない。
- 多項式同士の演算ができる。
    - 多項式 & 整数の演算もできるが、整数 → mint の (暗黙) キャストを 1 枚噛ませる。   
    - 整数 → mint があることで、整数 ver. mint ver. のように複数の演算を宣言しなくて OK
- 係数を変化させたりすると次数も変化する可能性がある(最高次係数を 0 にした場合など)
    - 適切なタイミングで format 関数を呼び出して A を整形する
    - format() := A.back()が 0 であるかぎり、pop_back する。ただし、A[0] = 0の場合はpopしない
    - format()は自分自身への自分自身への参照を返すことに注意!!!!
    - バグをなくすため、基本的にオブジェクトが呼び出される全てのタイミングで format() を呼び出すようにする
        - 基本的に、format() 後の A に準拠するようにしてください
    - ただし、[] 演算子で領域外にアクセスした場合は 係数 0 の領域を確保し、そのタイミングに限って format() されていない状態を許容する
    - [] 演算子は、要素の参照を返す(代入などができる)
        - [] などでアクセスした後はなるべく自力でformat()してください
- 次数の上限 deg_max を 設定する!!!
    - 次数が deg_max を超える部分は切り捨てる。
    - 余分に設定しておく方が良いが、遅い場合は set_max_deg で必要な分だけ確保する。
    - deg_max を小さくした場合、それ以前に計算した deg_max より大きい項は 0 になるので注意
    - 新たに FPS を生成するときも、set_deg を忘れないで

