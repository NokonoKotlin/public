# modlib

modint , FFT , FPS ライブラリ

参照する演算が複数存在するような状況を回避するため、modint と FPS のキャスト関係は作らない。


Copyright (c) 2024 NokonoKotlin(okoteiyu) Released under the MIT license(https://opensource.org/licenses/mit-license.php)


## NokonoKotlin のお気持ち
ライセンスを守って使って欲しいよ (ライブラリの冒頭に以下を書くだけ)
- Copyright ©️ (c) 2024 NokonoKotlin(okoteiyu) Released under the MIT license(https://opensource.org/licenses/mit-license.php)

## modint

- 素数 MOD つき整数。自動で mod をとってくれる。また、MOD が定数なのでコンパイラによる最適化が行われる。
- 基本的な演算は整数型と同じような設計にしてあり、整数型との演算も行える。
- MOD が素数なので、$0$ 以外には必ず逆数が存在する。
##### 設計
- `mylibrary/README` のライブラリ設計規則を参照
- 整数型 -> modint のキャストは暗黙
    - これにより、modint 同士の演算のみ定義しておけば、整数型との演算もカバーできる
- modint -> 整数型 のキャストは明示的
    - 参照する演算が複数存在するような状況を回避するため。
- 一応比較演算子も用意しておく (std::max,min,set などに使用できるように)
  

## FFT (FastFourierTransform)
- MOD 付きのフーリエ変換 & 畳み込み
- MOD は NTT-friendly な素数のみ
    - $998244353$ の場合は列サイズが $2^{23}$  まで OK




## FPS (Formal Power Series)
- 多項式を扱うクラス。
    - 係数は MOD 付き整数
- $x^i$ の係数を `A[i]` と置く。
    - 整数を定数項のみの多項式にキャストして扱うことで、実装の共通化をしている
    - mod 付き整数 (剰余環) なので、$0$ 以外の整数 (定数項のみの多項式) に対して必ず逆数が存在するような場合がある (mod998244353の場合など)。この時、定数項のみの多項式同士で「%」演算をしても、欲しい結果は得られない !!!!!! 「%」演算はあくまで多項式の徐算である。係数は剰余環であることを忘れないでね
- この式は $|A|-1$ 次式である。
    
##### 設計 & 仕様
- 自身のメンバを変化させるので、const 参照はできない。
- 多項式同士の演算ができる。
- 係数を変化させたりすると次数も変化する可能性がある (最高次係数を 0 にした場合、次数が減る)。
    - 適切なタイミングで format 関数を呼び出して A を整形する
        - `format()` := `A.back()` が $0$ であるかぎり `pop_back` する。ただし、`A[0]` $= 0$ の場合は `pop` しない
        - FPS の実装を含むメンバ関数の冒頭と、値を返す前に必ず呼ぶ。
    - バグをなくすため、基本的にオブジェクトが呼び出される全てのタイミングで `format()` を呼び出すようにする
        - 基本的に、`format()` 後の A に準拠するようにしてください
    - `[i]` 演算子は $x^i$ の次数のコピーを返す
    - `set(i,d)` := $x^i$ の係数を $d$ にする 
        - $0$ を `set` すると `format` が発生するかもしれないのでかなり注意
    - `cin_and_set(i)` := 入力から $d$ を受け取り、$x^i$ の係数を $d$ にする 
- 次数の上限 `deg_max` を 設定する!!!
    - 次数が `deg_max` を超える部分は切り捨てる。
    - 余分に設定しておく方が良いが、遅い場合は `set_max_deg` で必要な分だけ確保する。
    - `deg_max` を小さくした場合、それ以前に計算した `deg_max` より大きい項は $0$ になるので注意
    - 新たに FPS を生成するときも、`set_deg` を忘れないで
- 注意
    - 整数も定数項のみの FPS (多項式) として扱う。
    - オペレータは FPS と整数の掛け算,割り算に FFT,ダブリング を使うため、整数との演算では for 文を回すプログラムを書く方が良い

